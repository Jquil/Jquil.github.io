# 前言

在工作中经常会有这么个需求，需要将数据导入、导出为Excel文件，这里记录一下实现过程~





# 后端实现
NPOI
要求：

【1】封装成ExcelUtil,实现多个重载

【2】单元格格式、样式、合并、对齐

【3】导入（path、file）


开一个WinForm项目，添加DataGridView和Button控件，添加一点数据~

```
namespace WinFormsApp1
{
    public partial class Form1 : Form
    {
        DataTable dt;

        public Form1()
        {
            InitializeComponent();
            dt = new DataTable();
            DataColumn dc1 = new DataColumn("column1");
            DataColumn dc2 = new DataColumn("column2");
            dt.Columns.Add(dc1);
            dt.Columns.Add(dc2);
            for (int i = 0; i < 5; i++) {
                dt.Rows.Add(new string[]{i + ".", "data" + i});
            }
            dataGridView1.DataSource = dt;
        }
    }
}
```

<div align='center'>

![](https://static.jqwong.cn/20211106001.PNG)
</div>


然后我们添加NPOI包

<div align='center'>

![](https://static.jqwong.cn/20211106002.PNG)
</div>


### 新建


我们只需要编辑以下代码，然后点击按钮，就会生成好一个Excel文档

```
using NPOI.HSSF.UserModel;
using System.IO;
namespace WinFormsApp1
{
    public partial class Form1 : Form
    {
        
        private void button1_Click(object sender, EventArgs e)
        {
            HSSFWorkbook hwb = new HSSFWorkbook();
            hwb.CreateSheet("sheet1");
            hwb.CreateSheet("sheet2");
            hwb.CreateSheet("sheet3");
            FileStream fs = new FileStream("D:/demo.xls", FileMode.Create);
            hwb.Write(fs);
            fs.Close();
        }
    }
}
```


### 导出


现在我们实现将DataGridView的数据导出Excel中，对代码进行改造：

```
using NPOI.HSSF.UserModel;
using NPOI.SS.UserModel;
using System.IO;
namespace WinFormsApp1
{
    public partial class Form1 : Form
    {
        
        private void button1_Click(object sender, EventArgs e)
        {
            HSSFWorkbook hwb = new HSSFWorkbook();
            hwb.CreateSheet("sheet1");
            hwb.CreateSheet("sheet2");
            hwb.CreateSheet("sheet3");

            ISheet sheet0 = hwb.GetSheetAt(0);
            for (int i = 0; i < dt.Rows.Count; i++) {
                IRow row = sheet0.CreateRow(i);                             // 创建单元行
                row.CreateCell(0).SetCellValue(dt.Rows[i][0].ToString());   // 创建单元格并设置值
                row.CreateCell(1).SetCellValue(dt.Rows[i][1].ToString());
            }

            FileStream fs = new FileStream("D:/demo.xls", FileMode.Create);
            hwb.Write(fs);
            fs.Close();
        }
    }
}
```

<div align='center'>

![](https://static.jqwong.cn/20211106003.PNG)
</div>

导出成功~


### 样式处理

这里先只实现背景颜色，文字大小/颜色

```
using NPOI.HSSF.UserModel;
using NPOI.SS.UserModel;
using NPOI.HSSF.Util;
using System.IO;
namespace WinFormsApp1
{
    public partial class Form1 : Form
    {
        
        private void button1_Click(object sender, EventArgs e)
        {
            HSSFWorkbook hwb = new HSSFWorkbook();
            hwb.CreateSheet("sheet1");
            hwb.CreateSheet("sheet2");
            hwb.CreateSheet("sheet3");

            ISheet sheet0 = hwb.GetSheetAt(0);
            for (int i = 0; i < dt.Rows.Count; i++) {
                IRow row = sheet0.CreateRow(i);
                ICellStyle style = hwb.CreateCellStyle();
                IFont font = hwb.CreateFont();
                font.Color = HSSFColor.Red.Index;
                font.FontHeightInPoints = 16;
                style.SetFont(font);
                if (i % 2 == 0) {
                    style.FillForegroundColor = HSSFColor.Yellow.Index;
                    style.FillPattern = FillPattern.SolidForeground;
                }

                row.CreateCell(0).SetCellValue(dt.Rows[i][0].ToString());
                row.CreateCell(1).SetCellValue(dt.Rows[i][1].ToString());
                row.Cells[0].CellStyle = style;
                row.Cells[1].CellStyle = style;
            }

            FileStream fs = new FileStream("D:/demo.xls", FileMode.Create);
            hwb.Write(fs);
            fs.Close();
        }
    }
}
```

实现效果如下：
<div align='center'>

![](https://static.jqwong.cn/20211106004.PNG)
</div>


### 导入


# 前端实现

Vue ElementUI 

```
npm install file-saver
npm install xlsx
```

# 小结

关于C#-WinForm中实现Excel导出的实现先到这里，最后附上：


[1] [NPOI使用手册](https://www.cnblogs.com/joean/p/4661056.html)

[2] [vue+elementUI 表格下载为excel](https://blog.csdn.net/sunyan_blog/article/details/109500064)

[3] [Vue项目实现导入导出Excel表格功能](https://www.cnblogs.com/guwufeiyang/p/13245875.html)

[4] [web文件上传（三）--webapi后台接收参数和文件](https://blog.csdn.net/xcymorningsun/article/details/52950107)